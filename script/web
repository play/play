#!/bin/sh
#
# Start the web server

# Keep things nice for those on Boxen
if [ -n "$BOXEN_SOCKET_DIR" ]; then
  location="--socket $BOXEN_SOCKET_DIR/play"
else
  location="--port 5050"
fi

# Run this in prod, or dev?
#
# Production runs as daemonized and doesn't reload classes.
if [ -n "$RACK_ENV" ]; then
  env="$RACK_ENV"
  daemonized='--daemonize'
else
  env="development"
fi

case "$1" in
  start )
    bundle exec thin --environment $env $location --log /tmp/play/web.log --pid /tmp/play/web.pid $daemonized start
    ;;
  stop )
    if [ -f /tmp/play/web.pid ]
    then
      kill `cat /tmp/play/web.pid`
      rm -rf /tmp/play/web.pid
    fi
    ;;
esac
